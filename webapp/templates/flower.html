{% load staticfiles %}

<html>
{% include 'header.html' %}
<body id="top">

{% include 'flower_pagehead.html' with navbar=navbarOption %}
<div class="hoc" style="padding-top:0">
  <div style="display:inline-block; vertical-align:top" id="statpane">
    {% include 'statchart.html' with stats=stats yearSlider=yearSlider %}
  </div>
  <div style="display:inline-block; vertical-align:top">
    <div id="image-container" style="height:760px;">
      <ul class="nav nav-tabs" style="float:right">
        <li><button class="btn tab-btn inverse active" href="#tab-author" data-toggle="tab"><i class="fa fa-user"></i>&nbsp;Author</button></li>
        <li><button class="btn tab-btn inverse" href="#tab-conference" data-toggle="tab"><i class="fa fa-book"></i>&nbsp;Venue</button></li>
        <li><button class="btn tab-btn inverse" href="#tab-institution" data-toggle="tab"><i class="fa fa-university"></i>&nbsp;Institution</button></li>
      </ul>
      <!-- <div align="center" >
        legend-testtest (fix later)
        <div id="flower-legend"></div>
      </div> -->
      <!-- Tab content -->
      <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="tab-author">
          <div class="wrapper">
            <h4>To Author</h4>
            <div align="center">
              <svg id="graph1" width=1800 height=800></svg>
            </div>
          </div>
        </div>
        <div role="tabpanel" class="tab-pane" id="tab-conference">
          <div class="wrapper">
            <h4>To Venue</h4>
            <div align="center">
              <svg id="graph2" width=1800 height=800></svg>
            </div>
          </div>
        </div>
        <div role="tabpanel" class="tab-pane" id="tab-institution">
          <div class="wrapper">
            <h4>To Institution</h4>
            <div align="center">
              <svg id="graph3" width=1800 height=800></svg>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="disqus_thread"></div>
  </div>
</div>

<!-- Node information popup -->
<div id="node_info_modal" class="node_info_modal">
  <div id="node_info_container" class="node_info_container">
    <span class="close">&times;</span>
    <div id="node_info_content">
    </div>
  </div>
</div>
</body>
</html>
<script src="{% static 'js/d3.v4.min.js' %}"></script>
<script src="{% static 'js/d3-selection-multi.v1.min.js' %}"></script>
<script src="{% static 'js/d3-scale-chromatic.v1.min.js' %}"></script>
<script src="{% static 'js/flowerGraph.js' %}"></script>
<script>
option = '{{ navbarOption.selectedOption.id }}';
keyword = '{{ navbarOption.selectedKeyword }}';
author_data = {{ author|safe }}
conf_data = {{ conf|safe }}
inst_data = {{ inst|safe }}
var selfCiteCheckbox = document.getElementById('self-cite');
var coauthorCheckbox = document.getElementById('coauthor');

var width = document.getElementById('image-container').offsetWidth;
drawLegend();
drawFlower("#graph1", author_data, 0, width);
drawFlower("#graph2", conf_data, 1, width);
drawFlower("#graph3", inst_data, 2, width);


// Get the modal
var  node_info_modal = document.getElementById('node_info_modal');


// Get the <span> element that closes the modal
var node_info_close = document.getElementsByClassName("close")[0];


// When the user clicks on <span> (x), close the modal
node_info_close.onclick = function() {
    node_info_modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
    if (event.target == node_info_modal) {
        node_info_modal.style.display = "none";
    }
}

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
var page_url = '{{ request.build_absolute_uri }}';
var page_identifier = '{{ request.get_full_path }}';
var disqus_config = function () {
  this.page.url = page_url.split("&amp;pmin")[0];  // Replace PAGE_URL with your page's canonical URL variable
  this.page.identifier = page_identifier.split("&amp;pmin")[0]; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
(function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://influencemap-ml.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
